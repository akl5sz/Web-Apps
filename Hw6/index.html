<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script type="text/javascript" src="./connections.js"></script>
    <script>
      function Gamer(gamesPlayed, gamesWon, winStreak, avgNumberOfGuesses){
          this.gamesPlayed = gamesPlayed;
          this.gamesWon = gamesWon;
          this.winStreak = winStreak;
          this.avgNumberOfGuesses = avgNumberOfGuesses;
      }


      function setUpNewGame(newCategories) {
          let words = [];
          let count = 0;
          for (let i = 0; i < 4; i++) {
              for (let j = 0; j < 4; j++) {
              words[count] = newCategories["categories"][i]["words"][j];
              count++;
              }
          }
          drawGrid(words); //first game
          localStorage.setItem("currentWords", JSON.stringify(words));
          return words;
      }

      function selectWord(id) {
        var selectedWord = document.getElementById(id);
            if (selectedWord.classList.contains('selected')) {
                selectedWord.classList.remove('selected');
            } else {
                if (document.querySelectorAll('.selected').length < 4) {
                    selectedWord.classList.add('selected');
                } else {
                    alert('Only four choices can be selected!');
                }
            }
      }

      function drawGrid(words) {
        var table = document.getElementById("game-table");
          table.innerHTML = ""; 

          var newRow = table.insertRow(table.rows.length);
          for (let i = 0; i < words.length; i++) {
              if (i !== 0 && i % 4 === 0) {
                  newRow = table.insertRow(table.rows.length);
              }
              var newCell = newRow.insertCell(i % 4);
              newCell.innerHTML = "<button type=\"button\" class=\"btn btn-outline-primary\" id=\""+i+"\" onclick=\"selectWord(this.id);\">" + words[i] + "</button>";
          }
      }

      // function saveGameInfo() {
      //   // words = setUpNewGame(newCategories);
      //   localStorage.setItem("currentWords", JSON.stringify(words));
        
      // }

      function loadGameInfo() {
        var wordString = localStorage.getItem("currentWords");
        if (wordString != null) {
          words = JSON.parse(wordString);

          drawGrid(words);
        }
      }

  </script>
</head>
<style>
    .outter-container{
        display: flex;
        align-content: center;
        justify-content: center;
        flex-direction: row;
    }

    .container{
        display: flex;
        align-content: center;
        justify-content: center;
        flex-direction: column;
    }

    td {
        text-align: center;
    }

    #main-game{
        width: 100%;
    }

    .center {
        margin-left: auto !important;
        margin-right: auto !important;
    }
    
    .selected {
            background-color: blue !important;
            color: white;
    }
</style>

<body onload="loadGameInfo();" onunload="setUpNewGame();">
    
    <div style="margin: 250px;"></div>
    <div class="outter-container">
    <div class="container">
        <table class="table table-striped center" style="text-align: center; margin-top: 20px;">
            <thead>
              <tr>
                <th scope="col">Prior Guesses</th>
                <th scope="col">Unmatching Words</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Mark</td>
                <td>2</td>
              </tr>
              <tr>
                <td>Jacob</td>
                <td>1</td>
              </tr>
              <tr>
                <td>John</td>
                <td>2</td>
              </tr>
              <tr>
                <td>Mary</td>
                <td>1</td>
              </tr>
            </tbody>
          </table>
    </div>
    <div class="container" id="main-game">
        <p style="text-align: center;">[INSTRUCTIONS]</p>
        <div style="padding-bottom: 20px;">
            <table id="game-table" class="center">
            </table>
        </div>
        <div class="center">
            <button type="button" class="btn btn-success" onclick="getRandomCategories(setUpNewGame);">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-clockwise" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2z"></path>
                    <path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466"></path>
                </svg>
            </button>
            <button type="button" class="btn btn-outline-primary center">Submit Guess</button>
            <button type="button" class="btn btn-primary center">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-shuffle" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M0 3.5A.5.5 0 0 1 .5 3H1c2.202 0 3.827 1.24 4.874 2.418.49.552.865 1.102 1.126 1.532.26-.43.636-.98 1.126-1.532C9.173 4.24 10.798 3 13 3v1c-1.798 0-3.173 1.01-4.126 2.082A9.6 9.6 0 0 0 7.556 8a9.6 9.6 0 0 0 1.317 1.918C9.828 10.99 11.204 12 13 12v1c-2.202 0-3.827-1.24-4.874-2.418A10.6 10.6 0 0 1 7 9.05c-.26.43-.636.98-1.126 1.532C4.827 11.76 3.202 13 1 13H.5a.5.5 0 0 1 0-1H1c1.798 0 3.173-1.01 4.126-2.082A9.6 9.6 0 0 0 6.444 8a9.6 9.6 0 0 0-1.317-1.918C4.172 5.01 2.796 4 1 4H.5a.5.5 0 0 1-.5-.5"></path>
                    <path d="M13 5.466V1.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384l-2.36 1.966a.25.25 0 0 1-.41-.192m0 9v-3.932a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384l-2.36 1.966a.25.25 0 0 1-.41-.192"></path>
                </svg>
            </button>
        </div>
    </div>
    <div class="container">
        <table class="table table-striped center" style="text-align: center; margin-top: 20px;">
            <tbody>
              <tr>
                <td>Games Played:</td>
                <td>2</td>
              </tr>
              <tr>
                <td>Games Won:</td>
                <td>1</td>
              </tr>
              <tr>
                <td>Win Streak:</td>
                <td>2</td>
              </tr>
              <tr>
                <td>Average Number of Guesses:</td>
                <td>1</td>
              </tr>
            </tbody>
          </table>
    </div>
</div>
</body>
</html>